<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      onshow="#{chamadoControle.listar()}"
      >

    <ui:composition template="/template/template_#{loginControle.usuarioLogado.tipo}.xhtml" >
        <ui:define name="conteudo" >

            <f:view contentType="text/html" encoding="ISO-8859-1" >
                <h:form id="one" >
                    <p:growl id="growlMessages"/>
                    <meta content='text/html; charset=UTF-8' http-equiv="Content-Type" />

                    <p:panelGrid columns="2">
                        <p:commandButton action="#{historicoControle.Voltar()}" value="Voltar para Chamados" ajax="false" />
                        
                        <h:commandButton value="Imprimir" type="button" image="#{pageContext.request.contextPath}/imagens/imagens/imp.jpg" >  
                            <p:printer target="listagem" />  
                        </h:commandButton>

                    </p:panelGrid>

                    <p:dataTable id="listagem" value="#{historicoControle.lista}" var="item"  paginator="true" rows="15" filteredValue="#{historicoControle.filtroHistorico}">
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Data Atendimento"/>
                            </f:facet>
                            <h:outputText value="#{item.dataMarcada}">
                                <f:convertDateTime pattern="dd/MM/yyyy : HH:mm" timeZone="America/Sao_Paulo" locale="pt_BR" />
                            </h:outputText>
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Equipamento"/>
                            </f:facet>
                            <h:outputText value="#{item.equipamento.tipo}"/>
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Problema Relatado"/>
                            </f:facet>
                            <h:outputLink id="problema" value="#">  
                                <h:outputText value="#{item.problema}"/> 
                            </h:outputLink>  
                            <p:tooltip for="problema" value="#{item.observacoes}" showEffect="fade" hideEffect="fade" />  
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Prioridade"/>
                            </f:facet>
                            <h:outputText value="#{item.prioridade}"/> 
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Status"/>
                            </f:facet>
                            <h:outputText value="#{item.status}"/>
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Orçamento"/>
                            </f:facet>
                            <h:outputText value="#{item.orcamento}"/>
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Data Orçamento"/>
                            </f:facet>
                            <h:outputText value="#{item.dataOrcamento}">
                                <f:convertDateTime pattern="dd/MM/yyyy : HH:mm" timeZone="America/Sao_Paulo" locale="pt_BR" />
                            </h:outputText>
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Responsável"/>
                            </f:facet>
                            <h:outputText value="#{item.funcionario.nome}"/>
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Descrição"/>
                            </f:facet>
                            <h:outputText value="#{item.servico.descricao}"/>
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Resolução"/>
                            </f:facet>
                            <h:outputText value="#{item.resolucao}"/>
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Data Alteração"/>
                            </f:facet>
                            <h:outputText value="#{item.dataAlteracao}">
                                <f:convertDateTime pattern="dd/MM/yyyy : HH:mm" timeZone="America/Sao_Paulo" locale="pt_BR" />
                            </h:outputText>
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Data Fechamento"/>
                            </f:facet>
                            <h:outputText value="#{item.dataFechamento}">
                                <f:convertDateTime pattern="dd/MM/yyyy : HH:mm" timeZone="America/Sao_Paulo" locale="pt_BR"/>
                            </h:outputText>
                        </p:column>


                    </p:dataTable>

                </h:form>
            </f:view>
        </ui:define>
    </ui:composition>
</html>